---
title: "Create mailMessage"
description: "Create a new mailMessage object."
author: "**TODO: Provide Github Name. See [topic-level metadata reference](https://msgo.azurewebsites.net/add/document/guidelines/metadata.html#topic-level-metadata)**"
ms.localizationpriority: medium
ms.prod: "**TODO: Add MS prod. See [topic-level metadata reference](https://msgo.azurewebsites.net/add/document/guidelines/metadata.html#topic-level-metadata)**"
doc_type: apiPageType
---

# Create mailMessage
Namespace: microsoft.graph

[!INCLUDE [beta-disclaimer](../../includes/beta-disclaimer.md)]

Create a new [mailMessage](../resources/mailmessage.md) object.

## Permissions
One of the following permissions is required to call this API. To learn more, including how to choose permissions, see [Permissions](/graph/permissions-reference).

|Permission type|Permissions (from least to most privileged)|
|:---|:---|
|Delegated (work or school account)|**TODO: Provide applicable permissions.**|
|Delegated (personal Microsoft account)|**TODO: Provide applicable permissions.**|
|Application|**TODO: Provide applicable permissions.**|

## HTTP request

<!-- {
  "blockType": "ignored"
}
-->
``` http
POST /security/emailSecurityEvents/mailMessages
```

## Request headers
|Name|Description|
|:---|:---|
|Authorization|Bearer {token}. Required.|
|Content-Type|application/json. Required.|

## Request body
In the request body, supply a JSON representation of the [mailMessage](../resources/mailmessage.md) object.

You can specify the following properties when creating a **mailMessage**.

|Property|Type|Description|
|:---|:---|:---|
|createdDateTime|DateTimeOffset|Date and time when the email record was logged. Required.|
|networkMessageId|String|Internal identifier id for the email- generated by Microsoft 365. Required.|
|internetMessageId|String|Public-facing identifier for the email that is set by the sending email system. The message ID in the format specified by RFC2822. Required.|
|senderEmailFromAddress|String|Sender email address in the MAIL FROM header, also known as the envelope sender or the P1 sender. Optional.|
|senderFromAddress|String|Sender email address in the FROM header, which is visible to email recipients on their email clients. Also known as P2 Sender. Required.|
|senderDisplayName|String|Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname. Optional.|
|returnPath|String|Return-path is a the field that indicates where and how bounced emails will be processed. Optional.|
|senderIPv4|String|IPv4 address of the last detected mail server that relayed the message. Optional.|
|recipientEmailAddress|String|Email address of the recipient, or email address of the recipient after distribution list expansion. Required.|
|subject|String|Subject of the email. Required.|
|emailClusterId|String|Identifier for the group of similar emails clustered based on heuristic analysis of their contents. Optional.|
|directionality|directionality|Direction of the email relative to your network. The possible values are: `inbound`, `outbound`, `intraOrg`, `unknownFutureValue`. Optional.|
|originalDeliveryLocation|deliveryLocation|Location where the email was delivered originally. The possible values are: `inboxOrFolder`, `onPremisesOrExternal`, `junk`, `quarantine`, `failed`, `dropped`, `deletedItems`, `unknownFutureValue`. Required.|
|originalDeliveryAction|deliveryAction|Original Delivery action of the email, whether it was: Delivered, Junked, Blocked, or Replaced. The possible values are: `delivered`, `deliveredToJunk`, `blocked`, `replaced`, `unknownFutureValue`. Optional.|
|latestDeliveryLocation|deliveryLocation|Location where the email is currently placed after post delivery actions. The possible values are: `inboxOrFolder`, `onPremisesOrExternal`, `junk`, `quarantine`, `failed`, `dropped`, `deletedItems`, `unknownFutureValue`. Optional.|
|threatType|threatType|Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats. The possible values are: `spam`, `malware`, `phish`, `none`, `unknownFutureValue`. Optional.|
|detectionMethod|detectionMethod|Methods used to detect malware, phishing, or other threats found in the email. The possible values are: `generalFilter`, `impersonationBrand`, `spoofExternalDomain`, `spoofDmarc`, `impersonationDomain`, `fileDetonation`, `fileReputation`, `fileDetonationReputation`, `fingerPrintMatching`, `mailboxIntelligenceImpersonation`, `domainReputation`, `spoofIntraOrg`, `advancedFilter`, `antiMalwareEngine`, `mixedAnalysisDetection`, `urlMaliciousReputation`, `urlDetonation`, `urlDetonationReputation`, `impersonationUser`, `campaign`, `unknownFutureValue`. Optional.|
|threatDetail|[threatDetail](../resources/threatdetail.md)|Contain the threat information and detection details. Optional.|
|pishConfidenceLevel|String|Indicates the degree of confidence with which the phish threat was identified. Can be Normal or High. Optional.|
|spamConfidenceLevel|String|Indicates the degree of confidence with which the spam threat was identified. Can be Normal or High. Optional.|
|policyAction|emailActionPolicy|Action taken on the email based on the configured policy. We will get enums in this field. The possible values are: `moveMessageToJunkMailFolder`, `addXHeader`, `modifySubject`, `redirectMessage`, `deleteMessage`, `sendToQuarantine`, `noActionTaken`, `bccMessage`, `unknownFutureValue`. Optional.|
|policy|emailPolicy|Action policy that took effect: . The possible values are: `antispam`, `antiSpamHighConfidence`, `antiPhishingSpoof`, `antiPhishingDomainImpersonation`, `antiPhishingUserImpersonation`, `antiMalware`, `safeAttachments`, `exchangeTransportRule`, `antiPhishingGraphImpersonation`, `antiSpamBulkMail`, `antiSpamPhishing`, `unknownFutureValue`. Optional.|
|attachmentCount|String|Number of attachments in the email. Optional.|
|urlCount|String|Number of embedded URLs in the email. Optional.|
|language|String|Detected language of the email content. Optional.|
|connector|String|Email Connectors if set up, determine organizational mail flow and how the email was routed. Optional.|
|recipientTag|String|Tags applied to the recipient when they received the email. This is a comma separated list. Optional.|
|senderTag|String|Tags applied to the sender when they send the email. This is a comma separated list. Optional.|
|alertId|String|Comma separated values containing ID of any alert associated with the email. Optional.|
|submissionId|String|Comma separated values containing ID of any Submissions associated with the email. Optional.|
|junkMailboxRule|String|Junk mailbox rule, It is a rule set on the mailbox, which if enabled allows EOP to move messages to the Junk Email folder based on the spam filtering verdict action “Move message to Junk Email folder” or Blocked Senders list. Optional.|
|bulkComplaintLevel|String|Bulk complaint level (BCL), The bulk complaint level (BCL) of the message. A higher BCL indicates a bulk mail message is more likely to generate complaints (and is therefore more likely to be spam). Optional.|
|domainBasedMessageAuthentication|String|Domain-based Message Authentication. Indicates whether it was pass/fail/soft fail etc. Optional.|
|domainKeysIdentifiedMail|String|DomainKeys identified mail (DKIM). Indicates whether it was pass/fail/soft fail etc. Optional.|
|senderPolicyFramework|String|Sender Policy Framework (SPF). Indicates whether it was pass/fail/soft fail etc. Optional.|
|compositeAuthentication|String|This is a value used by Microsoft 365 to combine email authentication like SPF, DKIM, and DMARC, to determine if the message is authentic. Optional.|
|attachment|[securityEmailAttachments](../resources/securityemailattachments.md) collection|Collection of the Attachments in the Email. Optional.|
|url|[securityEmailUrls](../resources/securityemailurls.md) collection|Collection of URLs in the email. Optional.|
|distributionList|String|Distribution list details to which the email was sent. Optional.|
|senderEmailFromDomain|String|Sender domain in the MAIL FROM header, also known as the envelope sender or the Return-Path address. Optional.|
|senderFromDomain|String|Sender domain in the FROM header, which is visible to email recipients on their email clients. Also known as P2 Sender Domain. Optional.|
|domainOwner|String|Domain owner is the listed owner of the sending domain. Optional.|
|domainCreationDate|String|Shows the date on which the domain was created. Optional.|
|location|String|It is the last detected location of the sending IP address mail server. Optional.|
|exchangeTransportRule|String|Name of the ETRs which are part of the email. Optional.|



## Response

If successful, this method returns a `201 Created` response code and a [mailMessage](../resources/mailmessage.md) object in the response body.

## Examples

### Request
<!-- {
  "blockType": "request",
  "name": "create_mailmessage_from_"
}
-->
``` http
POST https://graph.microsoft.com/beta/security/emailSecurityEvents/mailMessages
Content-Type: application/json
Content-length: 1660

{
  "@odata.type": "#microsoft.graph.mailMessage",
  "networkMessageId": "String",
  "internetMessageId": "String",
  "senderEmailFromAddress": "String",
  "senderFromAddress": "String",
  "senderDisplayName": "String",
  "returnPath": "String",
  "senderIPv4": "String",
  "recipientEmailAddress": "String",
  "subject": "String",
  "emailClusterId": "String",
  "directionality": "String",
  "originalDeliveryLocation": "String",
  "originalDeliveryAction": "String",
  "latestDeliveryLocation": "String",
  "threatType": "String",
  "detectionMethod": "String",
  "threatDetail": {
    "@odata.type": "microsoft.graph.threatDetail"
  },
  "pishConfidenceLevel": "String",
  "spamConfidenceLevel": "String",
  "policyAction": "String",
  "policy": "String",
  "attachmentCount": "String",
  "urlCount": "String",
  "language": "String",
  "connector": "String",
  "recipientTag": "String",
  "senderTag": "String",
  "alertId": "String",
  "submissionId": "String",
  "junkMailboxRule": "String",
  "bulkComplaintLevel": "String",
  "domainBasedMessageAuthentication": "String",
  "domainKeysIdentifiedMail": "String",
  "senderPolicyFramework": "String",
  "compositeAuthentication": "String",
  "attachment": [
    {
      "@odata.type": "microsoft.graph.securityEmailAttachments"
    }
  ],
  "url": [
    {
      "@odata.type": "microsoft.graph.securityEmailUrls"
    }
  ],
  "distributionList": "String",
  "senderEmailFromDomain": "String",
  "senderFromDomain": "String",
  "domainOwner": "String",
  "domainCreationDate": "String",
  "location": "String",
  "exchangeTransportRule": "String"
}
```


### Response
>**Note:** The response object shown here might be shortened for readability.
<!-- {
  "blockType": "response",
  "truncated": true,
  "@odata.type": "microsoft.graph.mailMessage"
}
-->
``` http
HTTP/1.1 201 Created
Content-Type: application/json

{
  "@odata.type": "#microsoft.graph.mailMessage",
  "id": "fcb46c3e-6c3e-fcb4-3e6c-b4fc3e6cb4fc",
  "createdDateTime": "String (timestamp)",
  "networkMessageId": "String",
  "internetMessageId": "String",
  "senderEmailFromAddress": "String",
  "senderFromAddress": "String",
  "senderDisplayName": "String",
  "returnPath": "String",
  "senderIPv4": "String",
  "recipientEmailAddress": "String",
  "subject": "String",
  "emailClusterId": "String",
  "directionality": "String",
  "originalDeliveryLocation": "String",
  "originalDeliveryAction": "String",
  "latestDeliveryLocation": "String",
  "threatType": "String",
  "detectionMethod": "String",
  "threatDetail": {
    "@odata.type": "microsoft.graph.threatDetail"
  },
  "pishConfidenceLevel": "String",
  "spamConfidenceLevel": "String",
  "policyAction": "String",
  "policy": "String",
  "attachmentCount": "String",
  "urlCount": "String",
  "language": "String",
  "connector": "String",
  "recipientTag": "String",
  "senderTag": "String",
  "alertId": "String",
  "submissionId": "String",
  "junkMailboxRule": "String",
  "bulkComplaintLevel": "String",
  "domainBasedMessageAuthentication": "String",
  "domainKeysIdentifiedMail": "String",
  "senderPolicyFramework": "String",
  "compositeAuthentication": "String",
  "attachment": [
    {
      "@odata.type": "microsoft.graph.securityEmailAttachments"
    }
  ],
  "url": [
    {
      "@odata.type": "microsoft.graph.securityEmailUrls"
    }
  ],
  "distributionList": "String",
  "senderEmailFromDomain": "String",
  "senderFromDomain": "String",
  "domainOwner": "String",
  "domainCreationDate": "String",
  "location": "String",
  "exchangeTransportRule": "String"
}
```

